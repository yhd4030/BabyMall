<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>用户列表</title>
    <link rel="stylesheet" th:href="@{/layui/css/layui.css}">
    <link rel="stylesheet" th:href="@{/layui/css/dropdown.css}">
    <link rel="stylesheet" th:href="@{/css/bootstrap.min.css}">
    <link rel="stylesheet" th:href="@{/css/indexCss.css}">
    <link rel="stylesheet" th:href="@{/css/bs.css}">
    <link rel="stylesheet" th:href="@{/css/jquery-confirm.css}">

    <script th:src="@{/js/jquery-3.4.1.min.js}" type="application/javascript"></script>
    <script th:src="@{/js/bootstrap.min.js}" type="text/javascript"></script>
    <script th:src="@{/js/domlastic.js}" type="text/javascript"></script>
    <script th:src="@{/js/distpicker/distpicker.data.js}" type="application/javascript"></script>
    <script th:src="@{/js/distpicker/distpicker.js}" type="application/javascript"></script>
    <script th:src="@{/js/distpicker/main.js}" type="application/javascript"></script>
    <script th:src="@{/js/jquery-confirm.js}" type="text/javascript"></script>
    <script th:src="@{/js/validate/jquery.validate.js}" type="text/javascript"></script>
</head>
<body>
<script th:if="${}">

</script>
<div class="container" style="border: 1px solid #CCCCCC;height: auto;">

    <div style="height:100px;border-bottom: 1px solid #CCCCCC;padding-top:30px;margin-bottom: 10px">
        <h2 class="h2">用户列表</h2>
    </div>

    <table class="table table-hover">
        <caption>用户列表</caption>
        <thead>
        <tr>
            <th>序号</th>
            <th>用户名</th>
            <th>昵称</th>
            <th>性别</th>
            <th>手机号码</th>
            <th>邮箱地址</th>
            <th>居住城市</th>
            <th>职业</th>
            <th>状态</th>
            <th>操作</th>
        </tr>
        </thead>
        <tbody>
            <tr th:id="${user.id}"  th:each="user:${userList.list}">
                <td th:text="${user.id}"></td>
                <td th:text="${user.username}"></td>
                <td th:text="${user.nickname}"></td>
                <td th:text="${user.gender==1?'男':'女'}"></td>
                <td th:text="${user.phone}"></td>
                <td th:text="${user.email}"></td>
                <td th:text="${user.location}"></td>
                <td th:text="${user.detail_address}"></td>
                <td>1</td>
                <td>
                    <button type="button" class="btn btn-xs btn-info" th:onclick="|editUser(${user.id})|">
                        <span class="glyphicon glyphicon-pencil"></span> 编辑
                    </button>
                    <button type="button" class="btn btn-xs btn-danger" th:onclick="|deleteUser(${user.id})|">
                        <span class='glyphicon glyphicon-remove'></span> 删除
                    </button>
                </td>
            </tr>
        </tbody>
    </table>
    <nav aria-label="Page navigation" style="text-align: center">
        <ul class="pagination">
            <li th:if="${userList.hasPreviousPage}">
                <a th:href="'?pageNum=1'" aria-label="Previous">
                    <span aria-hidden="true">&laquo;</span>
                </a>
            </li>
            <li th:if="${userList.hasPreviousPage}"><a th:href="'?pageNum='+${userList.prePage}"><</a></li>
            <li th:each="nav : ${userList.navigatepageNums}">
                <a th:href="'?pageNum='+${nav}" th:text="${nav}"
                   th:if="${nav != userList.pageNum}">
                </a>
                <span style="font-weight: bold" th:if="${nav == userList.pageNum}" th:text="${nav}"></span>
            </li>
            <li th:if="${userList.hasNextPage}">
                <a th:href="'?pageNum='+${userList.nextPage}">
                   >
                </a>
            </li>
            <li th:if="${userList.hasNextPage}">
                <a th:href="'?pageNum='+${userList.pages}" aria-label="Next">
                    <span aria-hidden="true">&raquo;</span>
                </a>
            </li>
        </ul>
    </nav>
</div>
</body>
<script type="text/javascript">

    function editUser(userId) {
        location.href = "/admin/user/edit/?id="+userId;
    }

    //根据id删除用户
    function deleteUser(userId) {
        var $idStr="#"+userId;
        $.confirm({
            title: '删除',
            content: '您确定删除这个用户？',
            type: 'red',
            buttons: {
                ok: {
                    text: "确定",
                    btnClass: 'btn-danger',
                    keys: ['enter'],
                    action: function () {
                        $.ajax({
                            type:"POST",
                            url:"/admin/user/deletion/",
                            data:{id:userId},
                            success:function () {

                            }
                        });
                        domLastic.init({
                            itemsClassnameToConnect: 'cart_item', //类选择器
                            itemsJointStrength: 10, //value optimum between 10 - 100
                            animationSpeed: 500, //value optimum 300 - 1000 动画速度
                            animationIntensity: 0.6, //value optimum optimum 0.5 - 1
                            animationDirection: 'horizontal', //动画方向
                            callback: function () {
                                console.log('anim finished');
                            }
                        });
                        domLastic.animateItems();
                        $($idStr).slideToggle(150, function () {
                            $($idStr).remove();
                            //aniamte ListItems
                            domLastic.animateItems();
                        });
                    }
                },
                cancel: {
                    text: "取消"
                }
            }
        });

    }

</script>
</html>